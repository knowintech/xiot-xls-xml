{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts","webpack:///fs (ignored)","webpack:///crypto (ignored)","webpack:///stream (ignored)"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","routes","path","redirectTo","AppRoutingModule","forRoot","useHash","imports","window","Buffer","Uint8Array","DEVICETYPE","AppComponent","http","msg","uploading","fileList","beforeUpload","file","console","log","parseForm","reader","FileReader","readAsArrayBuffer","onload","data","target","result","workbook","type","firstSheetName","SheetNames","worksheet","Sheets","listOfData","sheet_to_json","index","editIndex","json","getJsonOfSale","getJsonOfTech","json_to_sheet","book_new","book_append_sheet","body","JSON","parse","devices","filter","类别","SMART","device","xmlString","stringify","compact","spaces","blob","Blob","a","document","createElement","href","URL","createObjectURL","download","style","display","appendChild","click","remove","dataList","find","ele","产品名称","名称","sum","reduce","pre","current","计数","sale","型号","规格","描述","产品描述","单位","单价","总价","备注","push","add","count","tech","编号","区域","区域名称","区域内序号","内序号","设备名称","SN","ID","位置码","copy","saveToSheet","$event","stopPropagation","saveToXml","selector","templateUrl","styleUrls","AppModule","provide","useValue","declarations","providers","bootstrap","environment","SERVER_URL","CONTROLLER_URL","ACCOUNT_URL","AP_URL","GUIDE_URL","DEVICE_URL","MIOT_URL","VERSION","version","mock","prod","dev","stage","bootstrapModule","err","error"],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '**',\r\n    /* component: HomeComponent */\r\n    redirectTo: '/'\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forRoot(routes, {useHash: true}), ],\r\n  exports: [RouterModule]\r\n})\r\nexport class AppRoutingModule { }\r\n","import { HttpClient, HttpRequest, HttpResponse } from '@angular/common/http';\r\nimport { Component } from '@angular/core';\r\nimport { NzMessageService } from 'ng-zorro-antd/message';\r\nimport { UploadFile } from 'ng-zorro-antd/upload';\r\nimport { json2xml } from 'xml-js';\r\nimport * as xlsx from 'xlsx';\r\n(window as any).Buffer = Uint8Array;\r\ninterface Data {\r\n  计数: number;\r\n  名称: string;\r\n  ID: string;\r\n  SN: string;\r\n  类别: number;\r\n  产品描述: string;\r\n  单价: number;\r\n  单位: string;\r\n  规格: string;\r\n  内序号: string;\r\n  区域名称: string;\r\n  位置码: string;\r\n  型号: string;\r\n  备注: string;\r\n}\r\n\r\ninterface SaleData {\r\n  计数: number;\r\n  产品名称: string;\r\n  总价: number;\r\n  描述: string;\r\n  单价: number;\r\n  单位: string;\r\n  规格: string;\r\n  型号: string;\r\n  备注: string;\r\n}\r\n\r\ninterface TechData {\r\n  编号: number;\r\n  区域: string;\r\n  设备名称: string;\r\n  区域内序号: string;\r\n  型号: string;\r\n  规格: string;\r\n  SN: string;\r\n  ID: string;\r\n  位置码: string;\r\n  备注: string;\r\n}\r\n\r\nenum DEVICETYPE {\r\n  SMART = 1,\r\n  UNSMART = 0\r\n}\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.less']\r\n})\r\nexport class AppComponent {\r\n  DEVICETYPE = DEVICETYPE;\r\n  uploading = false;\r\n  fileList: UploadFile[] = [];\r\n  listOfData: Data[];\r\n  editIndex: number;\r\n\r\n\r\n  constructor(private http: HttpClient, private msg: NzMessageService) { }\r\n\r\n  beforeUpload = (file: UploadFile): boolean => {\r\n    console.log(file);\r\n    this.fileList = [file];\r\n    this.parseForm(file);\r\n    return false;\r\n  }\r\n\r\n  parseForm(file) {\r\n    const reader = new FileReader();\r\n    reader.readAsArrayBuffer(file);\r\n    reader.onload = (e: any) => {  // 数据读取完成后的回调函数\r\n      console.log(e);\r\n      const data = new Uint8Array(e.target.result);\r\n      const workbook = xlsx.read(data, { type: 'array' });  // workbook 是 xlsx 解析 excel 后返回的对象\r\n\r\n      const firstSheetName = workbook.SheetNames[0];  // 获取第一个 sheet 的名字\r\n      const worksheet = workbook.Sheets[firstSheetName];  // 获取第一个 sheet 的内容\r\n      const listOfData = xlsx.utils.sheet_to_json(worksheet);  // 使用 utils 里的方法转换内容为便于使用的数组\r\n\r\n      // 下面就是自己对数组进行操作就行了\r\n      console.log(listOfData);\r\n      this.listOfData = listOfData as any;\r\n\r\n    };\r\n  }\r\n\r\n  startEdit(index: number) {\r\n    this.editIndex = index;\r\n  }\r\n\r\n  stopEdit(): void {\r\n    console.log(1231)\r\n    this.editIndex = null;\r\n  }\r\n\r\n  saveToSheet(type: 'sale' | 'tech') {\r\n    const json: any = type === 'sale'\r\n      ? this.getJsonOfSale(this.listOfData)\r\n      : this.getJsonOfTech(this.listOfData);\r\n    console.log(json);\r\n    const worksheet = xlsx.utils.json_to_sheet(json);\r\n    const workbook = xlsx.utils.book_new();\r\n    xlsx.utils.book_append_sheet(workbook, worksheet, 'Sheet1');\r\n\r\n    /* save to file */\r\n    xlsx.writeFile(workbook, `SheetJS.xlsx`);\r\n  }\r\n\r\n  saveToXml() {\r\n    const body = JSON.parse('{\"_declaration\":{\"_attributes\":{\"version\":\"1.0\",\"encoding\":\"utf-8\"}}}');\r\n    body.devices = {};\r\n    const json = this.getJsonOfTech(this.listOfData.filter(data => data.类别 === DEVICETYPE.SMART));\r\n    body.devices.device = json;\r\n    const xmlString = json2xml(JSON.stringify(body), { compact: true, spaces: 4 });\r\n    console.log(xmlString);\r\n    const blob = new Blob([xmlString]); //  创建一个blob对象\r\n    const a = document.createElement('a'); //  创建一个<a></ a>标签\r\n    a.href = URL.createObjectURL(blob); //  response is a blob\r\n    a.download = `test.xml`; //  文件名称\r\n    a.style.display = 'none';\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    a.remove();\r\n  }\r\n  getJsonOfSale(dataList: Data[]) {\r\n    const json: SaleData[] = [];\r\n    for (const data of dataList) {\r\n      if (json.find(ele => ele.产品名称 === data.名称)) {\r\n        continue;\r\n      }\r\n      const sum = dataList\r\n        .filter(ele => ele.名称 === data.名称)\r\n        .reduce((pre, current) => {\r\n          current.计数 += pre.计数;\r\n          return current;\r\n        });\r\n      const sale: SaleData = {\r\n        型号: data.型号 || null,\r\n        产品名称: data.名称 || null,\r\n        规格: data.规格 || null,\r\n        描述: data.产品描述 || null,\r\n        单位: data.单位 || null,\r\n        单价: data.单价,\r\n        计数: sum.计数,\r\n        总价: sum.计数 * data.单价,\r\n        备注: data.备注 || null,\r\n      };\r\n      json.push(sale);\r\n    }\r\n    return json;\r\n  }\r\n\r\n  getJsonOfTech(dataList: Data[]) {\r\n    const json: TechData[] = [];\r\n    const add = (() => {\r\n      let count = 0;\r\n      return () => {\r\n        return ++count;\r\n      };\r\n    })();\r\n    for (const data of dataList) {\r\n      const tech: TechData = {\r\n        编号: null,\r\n        区域: data.区域名称 || null,\r\n        区域内序号: data.内序号 || null,\r\n        设备名称: data.名称 || null,\r\n        型号: data.型号 || null,\r\n        规格: data.规格 || null,\r\n        SN: data.SN || null,\r\n        ID: data.ID || null,\r\n        位置码: data.位置码 || null,\r\n        备注: data.备注 || null\r\n      };\r\n      for (let index = 0; index < data.计数; index++) {\r\n        const copy = JSON.parse(JSON.stringify(tech));\r\n        copy.编号 = add();\r\n        json.push(copy);\r\n      }\r\n    }\r\n    return json;\r\n  }\r\n}\r\n","<div id=\"app\">\r\n  <nz-layout style=\"min-height: 100%;\">\r\n    <nz-header>Knowin Smart Web Tool！</nz-header>\r\n    <nz-content>\r\n      <nz-upload [(nzFileList)]=\"fileList\" [nzBeforeUpload]=\"beforeUpload\" [nzAccept]=\"['application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet']\">\r\n        <button nz-button><i nz-icon nzType=\"upload\"></i>选择文件(xls/xlsx)</button>\r\n        <button\r\n          nz-button\r\n          [nzType]=\"'primary'\"\r\n          (click)=\"saveToSheet('sale');$event.stopPropagation();\"\r\n          [disabled]=\"fileList.length == 0\"\r\n          style=\"margin-left: 20px;\"\r\n        >\r\n          销售向导出xlsx\r\n        </button>\r\n        <button\r\n          nz-button\r\n          [nzType]=\"'primary'\"\r\n          (click)=\"saveToSheet('tech');$event.stopPropagation();\"\r\n          [disabled]=\"fileList.length == 0\"\r\n          style=\"margin-left: 20px;\"\r\n        >\r\n          技术向导出xlsx\r\n        </button>\r\n        <button\r\n          nz-button\r\n          [nzType]=\"'primary'\"\r\n          (click)=\"saveToXml();$event.stopPropagation();\"\r\n          [disabled]=\"fileList.length == 0\"\r\n          style=\"margin-left: 20px;\"\r\n        >\r\n          导出xml\r\n        </button>\r\n      </nz-upload>\r\n      \r\n      <nz-table #editRowTable nzBordered [nzData]=\"listOfData\" style=\"margin-top: 20px;padding: 20px;\">\r\n        <thead>\r\n          <tr>\r\n            <th>计数</th>\r\n            <th>名称</th>\r\n            <th nzWidth=\"20%\">ID</th>\r\n            <th nzWidth=\"20%\">SN</th>\r\n            <th>类别</th>\r\n            <th>产品描述</th>\r\n            <th>单价</th>\r\n            <th>单位</th>\r\n            <th>规格</th>\r\n            <th>内序号</th>\r\n            <th>区域名称</th>\r\n            <th>位置码</th>\r\n            <th>型号</th>\r\n            <th>备注</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr *ngFor=\"let data of editRowTable.data; let idx = index\" class=\"editable-row\">\r\n            <td>{{ data['计数'] }}</td>\r\n            <td>{{ data['名称'] }}</td>\r\n            <td>\r\n              <ng-container *ngIf=\"data['类别'] != DEVICETYPE.SMART; else elseIDTemplate\">\r\n                /\r\n              </ng-container>\r\n              <ng-template #elseIDTemplate>\r\n                <div class=\"editable-cell\" [hidden]=\"editIndex === idx\" (click)=\"startEdit(idx)\">\r\n                  {{ data['ID'] }}\r\n                </div>\r\n                <input [hidden]=\"editIndex !== idx \" type=\"text\" nz-input [(ngModel)]=\"data['ID']\" (blur)=\"stopEdit()\" />\r\n              </ng-template>\r\n            </td>\r\n            <td>\r\n              <ng-container *ngIf=\"data['类别'] != DEVICETYPE.SMART; else elseSNTemplate\">\r\n                /\r\n              </ng-container>\r\n              <ng-template #elseSNTemplate>\r\n                <div class=\"editable-cell\" [hidden]=\"editIndex === idx\" (click)=\"startEdit(idx)\">\r\n                  {{ data['SN'] }}\r\n                </div>\r\n                <input [hidden]=\"editIndex !== idx\" type=\"text\" nz-input [(ngModel)]=\"data['SN']\" (blur)=\"stopEdit()\" />\r\n              </ng-template>\r\n            </td>\r\n            <td>{{ data['类别'] }}</td>\r\n            <td>{{ data['产品描述'] }}</td>\r\n            <td>{{ data['单价'] }}</td>\r\n            <td>{{ data['单位'] }}</td>\r\n            <td>{{ data['规格'] }}</td>\r\n            <td>{{ data['内序号'] }}</td>\r\n            <td>{{ data['区域名称'] }}</td>\r\n            <td>{{ data['位置码'] }}</td>\r\n            <td>{{ data['型号'] }}</td>\r\n            <td>{{ data['备注'] }}</td>\r\n          </tr>\r\n        </tbody>\r\n      </nz-table>\r\n    </nz-content>\r\n    <nz-footer>designed by angular</nz-footer>\r\n  </nz-layout>\r\n</div>\r\n\r\n","import { BrowserModule } from '@angular/platform-browser';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { AppRoutingModule } from './app-routing.module';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\n\r\n//\r\nimport { registerLocaleData } from '@angular/common';\r\nimport zh from '@angular/common/locales/zh';\r\n//\r\nimport { NZ_I18N } from 'ng-zorro-antd/i18n';\r\nimport { zh_CN } from 'ng-zorro-antd/i18n';\r\nimport { NzModalModule } from 'ng-zorro-antd/modal';\r\nimport { NzButtonModule } from 'ng-zorro-antd/button';\r\nimport { NzGridModule  } from 'ng-zorro-antd/grid';\r\nimport { NzLayoutModule } from 'ng-zorro-antd/layout';\r\nimport { NzDropDownModule } from 'ng-zorro-antd/dropdown';\r\nimport { NzIconModule } from 'ng-zorro-antd/icon';\r\nimport { NzTagModule } from 'ng-zorro-antd/tag';\r\nimport { NzAffixModule } from 'ng-zorro-antd/affix';\r\nimport { NzDividerModule } from 'ng-zorro-antd/divider';\r\nimport { NzInputNumberModule } from 'ng-zorro-antd/input-number';\r\nimport { NzDescriptionsModule } from 'ng-zorro-antd/descriptions';\r\nimport { NzFormModule } from 'ng-zorro-antd/form';\r\nimport { NzSliderModule } from 'ng-zorro-antd/slider';\r\nimport { NzSwitchModule } from 'ng-zorro-antd/switch';\r\nimport { NzRadioModule } from 'ng-zorro-antd/radio';\r\nimport { NzSpinModule } from 'ng-zorro-antd/spin';\r\nimport { NzDrawerModule } from 'ng-zorro-antd/drawer';\r\nimport { NzSelectModule } from 'ng-zorro-antd/select';\r\nimport { NzListModule } from 'ng-zorro-antd/list';\r\nimport { NzUploadModule } from 'ng-zorro-antd/upload';\r\nimport { NzTableModule } from 'ng-zorro-antd/table';\r\n\r\nimport { NzMessageService } from 'ng-zorro-antd/message';\r\n\r\n\r\n/* import {MatIconModule} from '@angular/material/icon'; */\r\n\r\n//\r\nimport { AppComponent } from './app.component';\r\n\r\n// service\r\n\r\nregisterLocaleData(zh);\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent,\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    AppRoutingModule,\r\n    FormsModule,\r\n    HttpClientModule,\r\n    BrowserAnimationsModule,\r\n\r\n    NzButtonModule,\r\n    NzGridModule,\r\n    NzLayoutModule,\r\n    NzDropDownModule,\r\n    NzIconModule,\r\n    NzTagModule,\r\n    NzAffixModule,\r\n    NzDividerModule,\r\n    NzInputNumberModule,\r\n    NzModalModule,\r\n    NzDescriptionsModule,\r\n    NzFormModule,\r\n    NzSliderModule,\r\n    NzSwitchModule,\r\n    NzRadioModule,\r\n    NzSpinModule,\r\n    NzDrawerModule,\r\n    NzSelectModule,\r\n    NzListModule,\r\n    NzUploadModule,\r\n    NzTableModule\r\n  ],\r\n  providers: [\r\n    NzMessageService,\r\n    { provide: NZ_I18N, useValue: zh_CN }\r\n  ],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build ---prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  //  SERVER_URL: `http://10.10.0.54:8014`,\r\n  SERVER_URL: `https://dev-iot-dvlp.knowin.com`,\r\n  CONTROLLER_URL: `https://dev-iot-api.knowin.com`,\r\n  ACCOUNT_URL: `https://dev-iot-account.knowin.com`,\r\n  AP_URL: 'dev-iot-ap.knowin.com',\r\n  GUIDE_URL: 'https://dev-iot-guide.knowin.com',\r\n  DEVICE_URL: 'https://dev-iot-spec.knowin.com',\r\n  MIOT_URL: 'http://miot-spec.org',\r\n  VERSION: require('../../package.json').version,\r\n  mock: false,\r\n  prod: false,\r\n  useHash: true,\r\n  dev: false,\r\n  stage: false\r\n};\r\n\r\n/*\r\n * In development mode, to ignore zone related error stack frames such as\r\n * `zone.run`, `zoneDelegate.invokeTask` for easier debugging, you can\r\n * import the following file, but please comment it out in production mode\r\n * because it will have performance impact when throw error\r\n */\r\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.prod) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n","/* (ignored) */","/* (ignored) */","/* (ignored) */"]}